---
title: "fourDNData"
author: "Jacques Serizay"
date: "`r Sys.Date()`"
output: 
    BiocStyle::html_document
vignette: >
    %\VignetteIndexEntry{fourDNData}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r, eval = TRUE, echo=FALSE, results="hide", message = FALSE, warning = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>"
)
suppressPackageStartupMessages({
    library(fourDNData)
})
```

## Access to 4DN data

fourDNData (read *4DN-Data*) is a data package giving programmatic access 
to Hi-C contact files uniformly processed by the 
[4DN consortium](https://www.4dnucleome.org/). The `fourDNData()` function 
provides a gateway to 4DN-hosted Hi-C files, including contact matrices 
(in `.hic` or `.mcool`) and other Hi-C derived files such as annotated 
compartments, domains, insulation scores, or pairs files.

```{r}
library(fourDNData)
head(fourDNData())
cool_file <- fourDNData('4DNESDP9ECMN')
cool_file
```

## HiCExperiment and fourDNData

The `HiCExperiment` package can be used to import `.mcool` files provided by 
`fourDNData`. Refer to `HiCExperiment` package documentation for further 
information. 

```{r}
library(HiCExperiment)
ID <- '4DNESDP9ECMN'
cf <- CoolFile(
    path = fourDNData(ID, type = 'mcool'), 
    metadata = as.list(fourDNData()[fourDNData()$experimentSetAccession == ID,])
)
x <- import(cf, resolution = 250000, focus = 'chr5:10000000-50000000')
x
interactions(x)
as(x, 'ContactMatrix')
```

Rather than importing multiple files corresponding to a single experimentSet 
accession ID one by one, one can import all the available files associated with 
a experimentSet accession ID into a `HiCExperiment` object by using the 
`fourDNHiCExperiment()` function.

```{r}
library(HiCExperiment)
x <- fourDNHiCExperiment('4DNESDP9ECMN')
```

## Session info

```{r}
sessionInfo()
```